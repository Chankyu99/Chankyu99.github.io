---
title: "[Statistics] 6장 다양한 가설검정"
description: "빅데이터 시대, 올바른 인사이트를 위한 통계X101 데이터분석"
date: 2025-12-10
categories: [Development, Statistics]
tags: [Statistics]
math: true
---

## 6.1 다양한 가설검정
> 다양한 가설검정 방법이 존재하지만, 목적과 데이터 성질에 맞는 적절한 방법을 선택해야 한다.

**<mark>모든 가설검정의 공통된 FLOW</mark>**
1. 귀무가설 설정 
2. 데이터로 검정통계량($t, F, \chi^2 \text{etc}$) 계산
3. 귀무가설이 옳다는 가정하에 통계량의 분포 확인
4. 통계량의 분포상 위치를 구하여 $p$값 계산

가설검정 방법을 선택할 때는 **데이터 유형**, **표본의 수**, **양적 변수 분포의 성질**을 먼저 확인한다.

- **데이터 유형** : 양적 변수인가? 질적 변수인가?
- **표본의 수**
    - 표본이 1개 : 특정 1개의 모집단분포에 대해 세운 가설 검증
    - 표본이 2개 : 두 모집단의 끼리의 차이 조사
    - 표본이 3개 : 다중비교를 통해 보정 필요
- **양적 변수의 성질**
    - **<mark>모수검정</mark>** : 모집단이 수학적으로 다룰 수 있는(모수로 설명가능한) 특정 분포를 따른다 
        - 예) **정규분포** -> 데이터가 **<mark>정규성(normality)</mark>**를 가짐
    - **<mark>비모수검정</mark>** : 모집단의 분포를 모수로 설정하지 않고 검정
    - **<mark>등분산성(equality of variance)</mark>** : 집단끼리 분산이 동일하다고 가정하고, 평균값을 비교


## 6.2 대푯값 비교

**<mark>일표본 t검정</mark>** : 표본이 1개인 경우 사용하는 모수검정법

어떤 평균값의 모집단에서 표본을 얻었는가를 조사한다. 

> - 귀무가설 : "모집단의 평균이 $\mu = ?$ 이다."
> - 대립가설 : "모집단의 평균이 $\mu \neq ?$ 이다."

일표본 t검정의 구체적인 계산 순서는 4장의 [평균값 95% 신뢰구간 구하기](https://chankyu99.github.io/posts/stastics4/)와 거의 같다.

다른부분은 마지막에 가설로 $\mu$를 지정하는 부분에서 가설이 옳은 가정에서의 표본평균 분포를 생각하는 것이다.

$$ \mu - 2\times \frac {s}{\sqrt{n}} \leq \bar x \leq \mu + 2 \times \frac {s}{\sqrt{n}}$$

> 마지막 식을 정리할 때, $\mu$가 아닌 $\bar x$로 정리한다.

**<mark>이표본 t검정</mark>** : 5장에서 [이표본 t검정](https://chankyu99.github.io/posts/stastics5/)에 대해 설명하였다.

❗️등분산성이 성립되지 않는다면, **<mark>웰치의 t검정</mark>**을 사용한다. 단, 정규성은 여전히 존재해야 한다.
    
**<mark>대응관계에 따른 검정분류</mark>**

- 대응관계 O : 동일한 대상의 전후 차이나, 쌍으로 묶인 집단 간의 비교
- 대응관계 X : 서로 관계없는 독립적인 두 집단 간의 평균 비교

**<mark>정규성 조사</mark>**

> - 귀무가설 : "모집단이 정규분포를 따른다."
> - 대립가설 : "모집단이 정규분포를 따르지 않는다."

- Q-Q 플롯 : 분위수-분위수 그림을 통해 정규성을 시각적으로 판단
- 가설검정 
    - 샤피로-윌크 검정
    - 콜모고로프-스미르노프(K-S) 검정

$p \geq 0.05$라면 정규성이 있고, $p < 0.05$라면 정규성이 없다는 판단하지만, 이것이 귀무가설의 옳고 그름을 판단할 수는 없다.

**<mark>등분산성 조사</mark>**

> - 귀무가설 : "두 모집단의 분산이 같다."
> - 대립가설 : "두 모집단의 분산이 다르다."

- 바틀렛 검정
- 레빈 검정

$p \geq 0.05$라면 등분산성이 있고, $p < 0.05$라면 등분산성이 없다는 판단하지만, 이것 역시 귀무가설의 옳고 그름을 판단할 수는 없다.

**<mark>분산분석(ANOVA)</mark>** : 3개 이상 집단의 평균값을 비교하는 방법

> - 귀무가설 : "모든 집단의 평균이 같다." ($\mu_1 = \mu_2 = \mu_3 = \dots = \mu_n$)
> - 대립가설 : "적어도 한 쌍에는 차이가 있다."

- 분산분석 원리
1. 집단의 차이를 무시하고 모든 데이터로 전체 평균 계산 
2. 각 집단의 평균 계산
3. 각 데이터와 평균의 차이 계산
4. 전체 평균과의 차이를 집단 내의 분산과 집단간의 분산의 2가지 요소로 분해

$$x_i - \bar x = \underbrace{(x_i - \bar x_j)}_{\text{집단내 변동}} + \underbrace{(\bar x_j - \bar x)}_{\text{집단간 변동}}$$

- **<mark>F값(F-value)</mark>** : 분산분석의 검정통계량, 귀무가설이 옳다는 가정하에 **<mark>F분포</mark>**를 따른다.

$$F = \frac{\text{평균적인 집단간 변동}}{\text{평균적인 집단내 변동}}$$

$F$분포에서 관찰한 $F$값 이상으로 극단적인 값이 나올 확률이 $p$값이다.

분포의 5% 지점은 이이상의 값이 될 확률이 5%인 지점을 나타낸다. 즉 $F$값이 이보다 오른쪽에 있다면 $p < 0.05$가 된다.

❓ **<mark>자유도</mark>** 
> 자유롭게 움직일 수 있는 변수의 수
> - 예 : 5명의 더치페이 ($n = 5$)에서 
> 처음의 4명까지는 자유롭게 움직일 수 있지만, 마지막 1명은 내야할 금액이 정해져 있다. 즉 $n-1$ ($=4$) 

**<mark>다중비교</mark>** : 분산분석을 통해 대립가설, 즉 어느 집단 쌍끼리 차이가 있는지 확인하는 방법

> "집단이 셋 이상일때 각 쌍의 차이를 조사하기 위해 이표본 t검정을 반복하면 되지않을까?" 

제1종 오류가 증가하고 마는 문제가 생기니 다중비교 검정을 통해 해결한다.

**<mark>다중비교 검정</mark>** : 분산분석 없이 단독 수행 가능
- **<mark>본페로니 검정</mark>** : 가장 보수적이고 엄격한 방법으로, 비교 횟수만큼 유의수준($\alpha$)을 나누어($\alpha/n$) 오차를 보정한다. (오류는 잘 막지만, 실제 차이를 놓칠 가능성도 큼)
- **<mark>튜키 검정</mark>** : **모든 가능한 집단의 쌍(Pair)**을 1:1로 비교할 때 가장 일반적으로 사용하는 방법이다. (집단 간 데이터 수가 같을 때 가장 정확함)
- **<mark>던넷 검정</mark>** : **하나의 대조군(Control)**과 나머지 실험군들을 각각 비교할 때 사용한다.
- **<mark>윌리엄스 검정</mark>** : 집단 간에 순서(농도, 용량 등)가 있을 때, 그 경향성을 고려하여 최저 유효 용량을 찾을 때 사용한다.

---

## 6.3 비율 비교

> Q. 범주형 변수의 경우, 어떤 방법으로 검정을 하는가?

**<mark>범주형 변수</mark>** : 모집단의 파라미터의 확률 $P$를 추정하거나 확률 $P$에 관련된 가설을 세워 검정한다.

**<mark>이항검정</mark>** : 하나의 범주가 발생할 확률이 $P$라고 하면, 나머지 하나의 범주가 발생할 확률이 $1-P$임을 이용해 검정

- 조건 : 사건 $\text{A}$가 발생할 확률이 $P$ 일때, $N$번의 <u>독립시행</u>일 것

- 이항분포 : 사건 $\text{A}$가 발생할 확률이 $P$ 일때, $N$번의 독립시행에서 $k$번 발생할 확률

$$\frac{N!}{k!(N-k)!}P^k(1-P)^{N-k}$$

**<mark>카이제곱검정</mark>** : 범주가 2개 이상인 일반적인 이산확률분포에 이항검정의 방식을 적용하는 방법

> - 귀무가설 : "모집단은 상정한 이산확률분포를 따른다."
> - 대립가설 : "모집단은 상정한 이산확률분포를 따르지 않는다."

(1) **<mark>적합도검정(goodness of fit test)</mark>**

데이터와 모집단사이 확률분포를 비교한 검정이다.

먼저 귀무가설의 확률분포에서 얻을 수 있는 기대도수를 계산한다.

$$ \text{기대도수} = \text{전체개수} \times P $$

기대도수를 활용한 아래 공식을 이용해 검정통계량 $\chi^2$를 구한다.

$$ \chi^2 = \sum \frac{(\text{실제 출현도수}-\text{기대도수})^2}{\text{기대도수}} $$

귀무가설이 옳다면 카이제곱분포를 따르므로 이 분포 안에서 실제로 얻은 $\chi^2$값의 위치를 구해 $p$값을 도출한다.

> 임의의 확률분포도 사용이 가능하다.

(2) **<mark>독립성검정(independence test)</mark>**

범주형 변수 사이의 관계를 조사할 때 사용한다.

먼저 범주형 변수 데이터를 분할표로 분리하여 정리한다.

$$ \begin{array}{c|cc|c} 
\text{분할표} & \text{범주1} & \text{범주2} & \text{합계} \\ \hline 
\text{범주1} & a & b & a+b \\ 
\text{범주2} & c & d & c+d \\ \hline 
\text{합계} & a+c & b+d & n \\ 
\end{array} $$

> - 귀무가설 : "두 변수 사이의 관계는 독립이다."
> - 대립가설 : "두 변수 사이의 관계는 독립이 아니다."

적합도검정과 기대도수를 구하는 공식이 다르며, 다음과 같다.

$$ \text{기대도수} = \frac{\text{행의 합} \times \text{열의 합}}{\text{전체 합}} $$

이후 과정은 적합성검정과 동일하게 $p$값을 구한다.

❗️ 피셔의 정확검정 : 데이터가 너무적어 카이제곱 검정을 쓰지 못할 경우 대안이 될 수 있다.

- 카이제곱의 한계 : 카이제곱은 모든 칸의 기대도수가 5 이상이어야 함. 데이터가 적다면 카이제곱 분포가 잘 맞지 않아 결과가 부정확해지기 때문이다.

- 피셔의 정확검정을 통해 **가능한 모든 경우의 수**를 직접 다 따져서 확률을 계산한다. 